import React from 'react';

import { API, localStorageApi } from 'services'

const loadUserInfo = (Component) => {
    class AsyncComponent extends React.Component {
        constructor() {
            super();
            this.loadInfo = this.loadInfo.bind(this);
        }

        loadInfo(token) {
            if(!token) return;
            API.Get(`self-users/?fields=id`)
                .then(res => {
                    const { id } = res.data;
                    localStorageApi.setItem('userId', id);
                    this.props.GetUserID({id})
                });
        }
     
        render() {
            return (
                <Component
                    loadUserInfo={this.loadInfo} 
                    {...this.props} 
                />
            )
        }
    }
    return AsyncComponent;
};

export default loadUserInfo;