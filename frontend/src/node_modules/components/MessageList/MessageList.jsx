import React from 'react';
import { MessageList, Input, Button, MessageBox} from 'react-chat-elements';

class List extends React.Component {
    constructor() {
        super();
        this.rightButtons = this.rightButtons.bind(this);
        this.onKeyPress = this.onKeyPress.bind(this);
    }

    rightButtons(e) {
        this.props.sendMessage(e.target.value)
        this.refs.input.clear();
        e.preventDefault();
        return false;
    }

    onKeyPress(e) {
        if (e.shiftKey && e.charCode === 13) {
            return true;
        }
        if (e.charCode === 13) {
            this.props.sendMessage(e.target.value)
            this.messageInput.clear();
            e.preventDefault();
            return false;
        }
    }

    render() {
        const { messageList, renderMessageList, sendMessage } = this.props;
        return (
            <div>
                <MessageList
                    className='message-list'
                    lockable={true}
                    toBottomHeight={'50%'}
                    dataSource={renderMessageList(messageList)} 
                />
                <Input
                    placeholder="Type here..."
                    defaultValue=""
                    ref={(input) => {this.messageInput = input}}
                    multiline={true}
                    rightButtons={
                        <Button 
                            text="Send"
                            onClick={this.rightButtons}
                        />
                    }
                    onKeyPress={this.onKeyPress}
                />
            </div>
        )
    }
}

export default List;