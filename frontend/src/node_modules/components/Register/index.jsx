import React, { Component } from 'react';
import { connect } from 'react-redux';
import { withRouter, Link } from 'react-router-dom';
import { SubmissionError } from 'redux-form';
import { REGISTER, isFailure, isLoading, isSuccess } from '../../actions';
import { postPattern } from 'services/sendAccount';
import Form from './Form';
import 'styles/auth.css'
class Register extends Component {
    formSubmit = values => {
        this.props.isLoading(REGISTER);
        return postPattern('api/register', values).then(
            req => {
                this.props.isSuccess(REGISTER);
                this.props.history.push('/');
            },
            err => {
                this.props.isFailure(REGISTER);
                throw new SubmissionError({
                    email: 'Email already exist.',
                    _error: 'Login failed!',
                });
            }
        );
    };
    render() {
        return (
            <div className="container-contact100">
                <div className="wrap-contact100">
                <div className='contact100-form'>
                    <div className='tabs flex-row'>
                        <Link to="/login" className="tab contact100-form-title">
                            Sign In
                        </Link>
                        <span className="tab contact100-form-title active">
                            Sign Up 
                        </span>
                    </div>
                        <Form formSubmit={this.formSubmit} />
                    </div>
                        <div className="contact100-more flex-col-c-m" style={{background: "linear-gradient(120grad, #643986, #98aed5)"}}>
                    </div>
                </div>
            </div>
        );
    }
}

export default withRouter(connect(null, { isFailure, isLoading, isSuccess })(Register));
